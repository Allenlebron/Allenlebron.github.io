---
layout:     post
title:      聊聊大数据离线平台
subtitle:   
date:       2019-08-20
author:     zwilpan
header-img: img/post-bg-ios9-web.jpg
catalog: true
tags:
    - BigData
---

在搭建之前我们要清楚大数据离线平台的适用场景，主要是对分析结果的时效性要求比较低，业务场景不要求很及时的数据反馈，对机器的性能要求比较低。简单来说以较低的成本来挖掘数据潜在的价值



一般会用到的技术：MapReduce，Hive，SparkCore(Spark on yarn)等



离线数据平台架构

![avatar](/img/bigdatastructure.jpeg)





数据仓库技术上，主要有 OLTP 和 OLAP.

OLTP的全称是Online Transaction Processing，顾名思义，OLTP数据库主要用来进行事务处理，比如新增一个订单、修改一个订单、查询一个订单和作废一个订单等。OLTP数据库最核心的需求是单条记录的高效快速处理，索引技术、分库分表等最根本的诉求就是解决此问题。

OLAP数据库本身就能够处理和统计大量的数据，而且不像OLTP数据库需要考虑数据的增删改查和并发锁控制等。OLAP数据一般只需要处理数据查询请求，数据都是批量导入的，因此通过列存储、列压缩和位图索引等技术可以大大加快响应请求的速度。

![avatar](/img/olapoltp.jpg)






数据分析平台数据来源  
1、服务器日志  
包括常用的例如nginx日志，apache日志，服务器系统日志等，一遍用于辅助运维工程师。



2、业务日志  
包括log4j的日志，用于节点异常排查，业务异常排查，debug等。



3、用户行为数据  
从前端收集到的用户操作行为的数据日志，比如浏览，点击，选择，收藏等。



数据处理的流程   
1、数据收集  
数据一般最终会以压缩格式保存于HDFS之上，目前市场公司用snappy压缩较多一些。



2、数据处理  
Extract-Transform-Load数据的清洗，过滤，转换等加工，根据指定的目标，计算数据指标的值，最终保存于数据库中SQL或者NoSQL。



3、数据结果可视化  
展示分析数据结果

可视化框架或工具：Zeppelin、Datawei、Echarts、HighCharts



技术架构


1、数据收集层

![avatar](/img/bigdatacollect.png)




数据采集层的任务就是把数据从各种数据源中采集和存储到数据存储上，期间有可能会做一些ETL操作。数据源种类可以有多种：



日志：所占份额最大，存储在备份服务器上

业务数据库：如Mysql、Oracle

来自HTTP/FTP的数据：合作伙伴提供的接口

其他数据源：如Excel等需要手工录入的数据







2、数据处理层

![avatar](/img/bigdatacompute.png)




刚刚采集到HDFS中的原生数据，我们也称为不规整数据，即目前来说，该数据的格式还无法满足我们对数据处理的基本要求，需要对其进行预处理，转化为我们后面工作所需要的较为规整的数据，所以这里的数据清洗，其实指的就是对数据进行基本的预处理，以方便我们后面的统计分析，所以这一步并不是必须的，需要根据不同的业务需求来进行取舍，只是在我们的场景中需要对数据进行一定的处理


3、数据展示层

![avatar](/img/bigdatashow.png)


最后通过后台接口调用以图表的形式将处理好的数据展示在web页面上就完成了整个流程。

